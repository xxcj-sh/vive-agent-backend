# 用户查询测试脚本使用说明

本目录包含用于查询数据库中用户信息的测试脚本。

## 脚本说明

### 1. test_query_users.py - 完整用户查询脚本

**功能特点：**
- 显示所有用户的完整详细信息
- 提供用户统计信息（总数、性别分布等）
- 支持交互式查询（按ID或OpenID查询）
- 格式化输出，易于阅读

**使用方法：**
```bash
# 在项目根目录下运行
python tests/test_query_users.py

# 或者在 tests 目录下运行
cd tests
python test_query_users.py
```

**功能菜单：**
1. 自动显示用户统计信息
2. 显示所有用户的完整信息
3. 交互式查询：
   - 按用户ID查询
   - 按微信OpenID查询
   - 重新显示所有用户
   - 退出程序

### 2. quick_user_query.py - 快速用户摘要脚本

**功能特点：**
- 以表格形式快速显示用户摘要
- 包含关键信息：ID、OpenID、昵称、性别、年龄、激活状态、创建时间
- 适合快速浏览和统计

**使用方法：**
```bash
# 在项目根目录下运行
python tests/quick_user_query.py

# 或者在 tests 目录下运行
cd tests
python quick_user_query.py
```

## 输出示例

### 完整查询脚本输出示例：
```
================================================================================
数据库用户查询测试脚本
================================================================================

📊 用户统计信息:
总用户数: 3
活跃用户: 2
非活跃用户: 1
男性用户: 1
女性用户: 1
未知性别: 1

👥 所有用户信息:
找到 3 个用户:

第 1 个用户:
============================================================
用户ID: 1
微信OpenID: ox1234567890abcdef
昵称: 张三
性别: 男
年龄: 25
身高: 175
体重: 70
职业: 软件工程师
教育程度: 本科
兴趣爱好: 编程,游戏
个人简介: 热爱技术的程序员
头像URL: https://example.com/avatar1.jpg
位置信息: 北京市
是否激活: 是
创建时间: 2024-01-15 10:30:00
更新时间: 2024-01-20 15:45:00
============================================================
```

### 快速查询脚本输出示例：
```
====================================================================================================
ID    OpenID                    昵称            性别   年龄   激活状态  创建时间
====================================================================================================
1     ox1234567890abcdef        张三            男     25    是       2024-01-15 10:30
2     ox9876543210fedcba        李四            女     23    是       2024-01-16 14:20
3     oxabcdef1234567890        王五            N/A    N/A   否       2024-01-17 09:15
====================================================================================================
总计: 3 个用户
```

## 注意事项

1. **环境要求：**
   - 确保数据库连接正常
   - 确保已安装所需的Python依赖包

2. **权限要求：**
   - 脚本需要数据库读取权限
   - 确保数据库配置文件正确

3. **错误处理：**
   - 脚本包含完整的错误处理机制
   - 如遇到连接问题，请检查数据库配置

4. **数据安全：**
   - 脚本仅用于测试和开发环境
   - 生产环境使用时请注意数据安全

## 扩展功能

如需添加更多查询功能，可以在脚本中添加：
- 按条件筛选用户（年龄范围、性别等）
- 导出用户数据到文件
- 用户数据验证和清理
- 批量操作功能

## 故障排除

**常见问题：**

1. **ModuleNotFoundError**: 确保在项目根目录运行脚本
2. **数据库连接失败**: 检查 `app/database.py` 中的数据库配置
3. **权限错误**: 确保数据库用户有读取权限

**调试方法：**
- 查看详细错误信息
- 检查数据库连接状态
- 验证模型定义是否正确