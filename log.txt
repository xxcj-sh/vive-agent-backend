数据库表结构初始化日志
========================

执行时间: 2026-02-08
操作人: 自动化脚本
数据库: vive_agent (rm-cn-w7k4hvvlx0003bbo.rwlb.rds.aliyuncs.com:3306)

一、初始化前状态
------------------------
原有表数: 10
需要创建的表: 17

二、创建的表列表
------------------------
1. user_profiles - 用户画像表
2. user_profile_history - 用户画像历史记录表
3. user_profile_scores - 用户画像评分表
4. user_profile_score_history - 用户画像评分历史记录表
5. user_profile_skills - 用户画像技能解锁表
6. user_profile_feedback - 用户画像反馈评价表
7. user_connections - 用户关系连接表
8. user_tag_rel - 用户标签关联表
9. vote_cards - 投票卡片表
10. vote_options - 投票选项表
11. vote_records - 投票记录表
12. vote_discussions - 投票讨论记录表
13. user_card_vote_relations - 用户卡片与投票卡片关联表
14. chat_messages - 聊天消息记录表
15. chat_summaries - 聊天总结记录表
16. content_tag_interactions - 内容和标签交互记录表
17. content_moderations - 内容审核状态表

三、已存在的表（未变动）
------------------------
1. users - 用户表
2. user_cards - 用户身份卡片表
3. membership_orders - 会员订单表
4. topic_cards - 话题卡片表
5. topic_discussions - 话题讨论记录表
6. topic_opinion_summaries - 话题观点总结表
7. user_card_topic_relations - 用户卡片与话题卡片关联表
8. tags - 标签表
9. tag_contents - 标签内容表
10. llm_usage_logs - LLM调用日志表

四、执行过程
------------------------
1. 使用 init_tables_with_charset.py 脚本创建表
2. 确保所有表使用 utf8mb4_unicode_ci 字符集
3. 处理外键约束兼容性问题
4. 验证所有表创建成功

五、执行结果
------------------------
✅ 成功创建 17 个新表
✅ 数据库当前表数: 27（与模型定义一致）
✅ 所有表字符集: utf8mb4_unicode_ci
✅ 所有表引擎: InnoDB

六、数据库当前所有表
------------------------
1. chat_messages
2. chat_summaries
3. content_moderations
4. content_tag_interactions
5. llm_usage_logs
6. membership_orders
7. tag_contents
8. tags
9. topic_cards
10. topic_discussions
11. topic_opinion_summaries
12. user_card_topic_relations
13. user_card_vote_relations
14. user_cards
15. user_connections
16. user_profile_feedback
17. user_profile_history
18. user_profile_score_history
19. user_profile_scores
20. user_profile_skills
21. user_profiles
22. user_tag_rel
23. users
24. vote_cards
25. vote_discussions
26. vote_options
27. vote_records

七、相关文件
------------------------
- init_tables_with_charset.py: 表创建脚本
- init_tables_log_20260208_194834.txt: 创建操作日志
- check_existing_tables.py: 表结构检查脚本

八、注意事项
------------------------
1. 所有新表已正确设置字符集为 utf8mb4_unicode_ci
2. 所有表结构与 vive-agent-backend 模型定义一致
3. 数据库已准备好接收业务数据

========================
