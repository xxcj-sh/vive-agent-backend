# 卡片匹配偏好设置设计文档

## 概述

本文档基于重新设计的卡片类型，为每种卡片拥有者设计了详细的匹配偏好设置。这些偏好设置将用于智能匹配算法，提高匹配的精准度和用户体验。

## 卡片类型与偏好设置对应关系

### 1. 活动组织者 (ActivityOrganizer)

**文件**: `app/models/card_preferences.py` -> `ActivityOrganizerPreferences`

**核心偏好设置**:
- **参与者筛选**: 年龄范围、期望参与人数
- **活动匹配**: 活动类型、地点偏好、预算要求
- **时间偏好**: 活动日期、时间段选择
- **质量要求**: 参与者历史记录、身份验证要求
- **匹配强度**: 宽松/中等/严格匹配模式

**使用场景**:
- 筛选合适的活动参与者
- 控制活动规模和质量
- 匹配活动时间和地点

### 2. 活动参与者 (ActivityParticipant)

**文件**: `app/models/card_preferences.py` -> `ActivityParticipantPreferences`

**核心偏好设置**:
- **组织者筛选**: 经验级别、评分要求
- **活动筛选**: 类型偏好、地理位置、通勤时间
- **预算控制**: 预算范围、费用分摊方式
- **时间管理**: 可用时间、提前通知要求
- **团队规模**: 期望的团队规模范围

**使用场景**:
- 找到靠谱的活动组织者
- 参与符合预算和时间安排的活动
- 控制活动参与体验

### 3. 找房者 (HouseSeeker)

**文件**: `app/models/card_preferences.py` -> `HouseSeekerPreferences`

**核心偏好设置**:
- **房源筛选**: 房屋类型、预算灵活性
- **地理位置**: 目标区域、通勤时间、周边设施
- **房屋配置**: 必需设施、家具偏好
- **室友匹配**: 室友要求、生活方式兼容性
- **租约灵活性**: 条款协商、入住时间弹性

**使用场景**:
- 精准筛选符合需求的房源
- 平衡预算与地理位置
- 匹配合适的室友

### 4. 房源 (House)

**文件**: `app/models/card_preferences.py` -> `HousePreferences`

**核心偏好设置**:
- **租客筛选**: 职业偏好、年龄范围、收入要求
- **租客质量**: 工作验证、推荐信要求
- **行为政策**: 吸烟政策、宠物政策
- **租约条款**: 租期偏好、付款频率
- **入住时间**: 期望入住时间段
- **自动化**: 自动批准符合条件的租客

**使用场景**:
- 筛选高质量租客
- 控制房源风险
- 提高出租效率

### 5. 约会交友 (Dating)

**文件**: `app/models/card_preferences.py` -> `DatingPreferences`

**核心偏好设置**:
- **基本条件**: 年龄、身高、教育、职业、收入
- **关系状态**: 期望的感情状态、寻找关系类型
- **兴趣匹配**: 共同兴趣权重、性格兼容性
- **地理位置**: 距离限制、位置偏好
- **外观偏好**: 风格、体型等外观要求
- **生活方式**: 生活习惯、价值观匹配
- **安全验证**: 身份验证、社交媒体验证

**使用场景**:
- 精准匹配合适的交友对象
- 平衡个人偏好与匹配成功率
- 确保交友安全

## 统一偏好管理

**文件**: `app/models/card_preferences.py` -> `CardPreferences`

**功能特性**:
- 统一管理所有卡片类型的偏好设置
- 提供类型安全的偏好获取和设置方法
- 支持序列化和反序列化
- 包含通知和隐私设置

**使用方法**:

```python
from app.models.card_preferences import CardPreferences

# 创建偏好设置
prefs = CardPreferences()
prefs.dating = DatingPreferences(preferred_age_range=[25, 35])

# 获取偏好
dating_prefs = prefs.get_preferences_by_type('dating')

# 序列化存储
prefs_dict = prefs.dict()
```

## 数据结构设计原则

### 1. 灵活性
- 所有偏好字段均为可选，支持渐进式配置
- 支持灵活的参数组合
- 适应不同用户的个性化需求

### 2. 类型安全
- 使用 Pydantic 模型确保数据类型正确
- 提供清晰的字段描述和验证
- 支持 IDE 自动补全和类型检查

### 3. 可扩展性
- 模型设计支持未来字段扩展
- 枚举值易于添加新选项
- 结构清晰，便于维护

### 4. 实用性
- 基于真实使用场景设计
- 平衡详细程度与易用性
- 支持匹配算法的精确计算

## 集成建议

### 前端集成
- 为每种偏好设置创建对应的配置界面
- 提供智能默认值和建议
- 支持分步配置，降低用户门槛

### 后端集成
- 在卡片创建/更新时保存偏好设置
- 在匹配算法中使用偏好设置进行筛选
- 提供偏好设置的 API 接口

### 匹配算法
- 根据偏好设置的严格程度调整匹配权重
- 支持偏好设置的动态调整
- 提供匹配结果解释功能

## 文件结构

```
app/models/
├── card_preferences.py      # 偏好设置模型定义
├── user_card.py            # 用户卡片模型（已集成偏好设置）
└── preference_examples.py   # 使用示例和测试数据
```

## 下一步计划

1. **前端实现**: 为每种卡片类型创建偏好设置界面
2. **API 开发**: 创建偏好设置的 CRUD 接口
3. **匹配算法**: 集成偏好设置到匹配逻辑
4. **用户引导**: 创建偏好设置的教学引导流程
5. **数据分析**: 收集偏好设置使用数据，优化推荐算法